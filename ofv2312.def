Bootstrap: docker
From: ubuntu:22.04

%environment
    export PYBIND11_INC_DIR=$(python3 -m pybind11 --includes)
    export PYBIND11_LIB_DIR=$(python3 -c 'import sysconfig; print(sysconfig.get_config_var("LIBDIR"))')
    . /usr/lib/openfoam/openfoam2312/etc/bashrc -f

%files

%post

    apt update
    apt install -y build-essential autoconf autotools-dev cmake gawk gnuplot wget git hwloc libpmi2-0 libpmi2-0-dev vim curl
    apt install -y flex libfl-dev libreadline-dev zlib1g-dev libgmp-dev libmpfr-dev libmpc-dev libscotch-dev libptscotch-dev libmetis-dev

    curl https://dl.openfoam.com/add-debian-repo.sh | bash
    apt update
    apt install -y openfoam2312-default

    apt install -y python3 python3-dev python3-pip fonts-cmu texlive
    pip3 install numpy pandas scipy scikit-learn matplotlib joblib pybind11 seaborn
 
    apt clean
    rm -rf /var/lib/apt/lists/*
